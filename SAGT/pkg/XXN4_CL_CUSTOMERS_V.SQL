
--drop view XXN4_CL_CUSTOMERS_V

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "SAGTUSER"."XXN4_CL_CUSTOMERS_V" ("ID","CL_PARTY_ID", "CL_PARTY_SITE_ID", "CL_CUSTOMER_STATUS", 
  "PARTY_USAGE_CODE", "CREATED_BY_MODULE", "ORGANIZATION_NAME", "CL_LOCATION_ID"
  , "CL_CUSTOMER_ERROR"
  ) AS 
  SELECT 
    ID,
    CL_PARTY_ID, 
    CL_PARTY_SITE_ID, 
    CL_CUSTOMER_STATUS,
    'CUSTOMER' PARTY_USAGE_CODE,
    'HZ_WS' CREATED_BY_MODULE,
    NAME ORGANIZATION_NAME,
    CL_LOCATION_ID
    ,CL_CUSTOMER_ERROR
FROM XXN4_SHIPPING_LINES
WHERE 1=1 --CL_CUSTOMER_STATUS = 'NEW'
AND CL_LOCATION_ID IS NOT NULL
and CL_PARTY_ID is null and CL_PARTY_SITE_ID is null;
